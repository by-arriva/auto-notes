<!DOCTYPE html>
<html manifest = "ma.appcache" >
<html>
<head>
	<title>Arriva</title>
	<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0" />
	<meta charset="UTF-8" >
	<style>
		* {
			font-family: sans-serif;
			font-size: 14px;
		}
		.butr {
			color: #ff0000;
		}
		textarea {
			width: 100%;
		}
	</style>
</head>
<body>
	<button class=but onclick=document.location=('index.html')>назад и обновить</button>
	<button class=butr onclick=del()>удалить</button>
	<br><br>
	<textarea class=text rows=20></textarea>
	<br>
	<button class=but onclick=c()>очистить</button> 
	<button class=but onclick=i()>импорт</button> 
	<button class=but onclick=e()>экспорт</button>
	<button class=but onclick=select()>выделить</button>
	<button class=but onclick=copy()>скопировать в буфер</button>
	<br><br>
	<input type='file' onchange='openFile(event)'/>
	<br><br>
	<textarea class=date rows=1>2021-02-03T12:00:00.000+03:00</textarea>
	<button class=but onclick=d()>дата → unixtime</button>
	<textarea class=result rows=1></textarea>
	<button class=but onclick=f()>unixtime → дата</button>
	<textarea class=formated rows=1></textarea>
</body>
</html>
<script>
	function del(){
		if(confirm("Удалить все заметки?")){
			localStorage.clear();
		}
	}
	function c(){
		document.querySelector('.text').value = "";
	}
	function i(){
		set(document.querySelector('.text').value);
	}
	function e(){
		for(var i=0; i<localStorage.length; i++) {
			var k = localStorage.key(i);
			var v = localStorage.getItem(k);
			document.querySelector('.text').value += k+v;
		}
	}
	function select(){
		var t = document.querySelector('.text');
		t.focus();
		document.execCommand('selectAll', false, null);
	}
	function copy(){
		select();
		document.execCommand('copy');
		t.blur();
	}
	function d(){
		document.querySelector('.result').value = Date.parse(document.querySelector('.date').value);
	}
	function f(){
		var d = new Date(document.querySelector('.result').value-0);
		var days = ["вс", "пн", "вт", "ср", "чт", "пт", "сб"];
		var da = d.getDate();
		var mo = d.getMonth()+1;
		var ho = d.getHours();
		var mi = d.getMinutes();
		document.querySelector('.formated').value = days[d.getDay()]+', '+(da<10 ? '0'+da : da)+'.'+(mo<10 ? '0'+mo : mo)+'.'+d.getFullYear()+' '+(ho<10 ? '0'+ho : ho)+':'+(mi<10 ? '0'+mi : mi);
	}
	function openFile(event){
		var input = event.target;
		var reader = new FileReader();
		reader.onload = function(){
			set(reader.result);
		};
		reader.readAsText(input.files[0]);
	}
	function set(t){
		var kv = t.split('}');
		for (var i=0; i<kv.length-1; i++){
			var kv1 = kv[i].split('{');
			localStorage.setItem(kv1[0], '{'+kv1[1]+'}');
		}
	}
</script>